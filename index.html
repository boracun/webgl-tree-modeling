<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tree Modeling and Animations with WebGL</title>

    <script id="vertex-shader" type="x-shader/x-vertex">
        attribute vec4 vPosition;
		attribute vec4 vNormal;
		varying vec4 fColor;

		uniform vec4 ambientProduct, diffuseProduct, specularProduct;
        uniform bool green;
        uniform mat4 modelViewMatrix;
        uniform mat4 projectionMatrix;
		
		uniform vec4 lightPosition;
		uniform float shininess;
		
		uniform bool renderShadingOption;

        void main()
        {
			// pos is vertex position in eye coordinates
			vec3 pos = (modelViewMatrix * vPosition).xyz;
			
			// vector from vertex position to light source
			vec3 L;
			
			// check for directional light
			if (lightPosition.w == 0.0)
				L = normalize(lightPosition.xyz);
			else
				L = normalize( lightPosition.xyz - pos );
			
			// Because the eye point the is at the orgin
			// the vector from the vertex position to the eye is
			vec3 E = -normalize( pos );
			
			// halfway vector
			vec3 H = normalize( L + E );
			
			// as long as there is no nonuniform scaling 
			// we don't need the normal matrix and can use
			
			//vec4 newNormal = modelViewMatrix * vNormal;
			//vec3 N = normalize((modelViewMatrix*newNormal).xyz);
			vec3 N = normalize((modelViewMatrix*vNormal).xyz);

			// Compute terms in the illumination equation
			vec4 ambient = ambientProduct;

			float Kd = max( dot(L, N), 0.0 );
			vec4  diffuse = Kd*diffuseProduct;

			float Ks = pow( max(dot(N, H), 0.0), shininess );
			vec4  specular = Ks * specularProduct;
			
			if( dot(L, N) < 0.0 ) {
			specular = vec4(0.0, 0.0, 0.0, 1.0);
			} 
			
            gl_Position = projectionMatrix * modelViewMatrix * vPosition;

            if(!green)
			{
                fColor = vec4(0.59, 0.29, 0.0, 1.0);
				
			}
            else
                fColor = vec4(0.0, 0.7, 0.0, 1.0);
				
				
			// fColor contradiction needs to be solved
			if ( renderShadingOption )
					fColor += ambient + diffuse + specular;
    
			fColor.a = 1.0;
        }
    </script>

    <script id="fragment-shader" type="x-shader/x-fragment">
        precision mediump float;
        varying vec4 fColor;

        void main()
        {
            gl_FragColor = fColor;
        }
    </script>

    <script type="text/javascript" src="Common/webgl-utils.js"></script>
    <script type="text/javascript" src="Common/initShaders.js"></script>
    <script type="text/javascript" src="Common/MV.js"></script>
    <script type="text/javascript" src="utils.js"></script>
    <script type="text/javascript" src="app.js"></script>

    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;400&family=Poppins:wght@300&display=swap" rel="stylesheet">
</head>
<body>
    <canvas id="gl-canvas" width="512" height="512">
    Oops ... your browser doesn't support the HTML5 canvas element
    </canvas>

    <div id="button-list" class="button-list">
        <button id="generate-tree-button">Generate Random Tree</button>
        <button id="decrease-camera-angle-button" class="button">Change Camera Angle CW</button>
        <button id="increase-camera-angle-button" class="button">Change Camera Angle CCW</button>
		<button id="color-render" class="button">Rendering Option: Color</button>
		<button id="shading-render" class="button">Rendering Option: Shading</button>
    </div>

    <div id="branch-list" class="button-list">
        <button id="trunk-button" class="button" disabled>Trunk</button>
    </div>

    <div id="rotation-list" class="button-list">
        <label for="x-rotation-number">Degrees of rotation about x-axis [-180, 180]: </label>
        <input type="number" id="x-rotation-number" min="-180" max="180" value="0">
        <input type="range" id="x-rotation-range" min="-180" max="180" value="0">

        <label for="y-rotation-number">Degrees of rotation about y-axis [-180, 180]: </label>
        <input type="number" id="y-rotation-number" min="-180" max="180" value="0">
        <input type="range" id="y-rotation-range" min="-180" max="180" value="0">

        <label for="z-rotation-number">Degrees of rotation about z-axis [-180, 180]: </label>
        <input type="number" id="z-rotation-number" min="-180" max="180" value="0">
        <input type="range" id="z-rotation-range" min="-180" max="180" value="0">
    </div>
</body>
</html>